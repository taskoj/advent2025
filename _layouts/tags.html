---
layout: page
---

{%- comment -%}
Tags listing layout. Expects `page.site_key` (calendar key) to be set in the page front matter.
Renders a section per tag that contains posts for the given calendar.
{%- endcomment -%}

{%- assign key = page.site_key | default: nil -%}
{%- if key == nil -%}
  <h1>Tags</h1>
  <p>No calendar specified.</p>
{%- else -%}
  {%- comment -%} default header values are taken from page.title/page.subtitle set in calendar pages (we set these in /henri/tags.md etc.) {%- endcomment -%}

  <div class="tags-container">
    {% comment %} Iterate all site tags and show only those that have posts in this calendar {% endcomment %}
    <div class="tags-list">
      {% for tag in site.tags %}
        {% assign tag_name = tag[0] %}
        {% assign tag_posts = tag[1] | where: "calendar", key %}
        {% if tag_posts and tag_posts.size > 0 %}
          {% assign tag_slug = tag_name | slugify %}
          <section id="{{ tag_slug }}" class="tag-section">
            <h2>{{ tag_name }}</h2>
            <ul class="list-unstyled">
              {% for post in tag_posts %}
              <li>
                <a href="{{ post.url | relative_url }}">{{ post.title }}</a>
              </li>
              {% endfor %}
            </ul>
          </section>
        {% endif %}
      {% endfor %}
    </div>
  </div>

  <script>
    // If the URL contains a hash (#slug), show only that tag's results and update header text
    document.addEventListener('DOMContentLoaded', function(){
      try {
        var hash = window.location.hash ? window.location.hash.substring(1) : '';
        if (!hash) return;
        var target = document.getElementById(hash);
        if (!target) return;

        // Replace the tags-list content with only the selected section
        var list = document.querySelector('.tags-list');
        if (list) {
          list.innerHTML = '';
          list.appendChild(target);
        }

        // Update the page header: set H1 to "Treffer zum Stichwort <Tag>" and keep subtitle if present
        var tagTitleEl = target.querySelector('h2');
        var tagTitle = tagTitleEl ? tagTitleEl.textContent.trim() : decodeURIComponent(hash);

        // page heading H1 in header include
        var pageHeading = document.querySelector('.page-heading h1');
        if (pageHeading) {
          pageHeading.textContent = 'Advent 2025';
        }

        // Ensure subtitle remains the calendar subtitle (already set in front matter), so do not change it

        // Scroll to the section top (account for fixed navbar)
        var y = target.getBoundingClientRect().top + window.pageYOffset - (document.querySelector('.navbar') ? document.querySelector('.navbar').offsetHeight + 10 : 0);
        window.scrollTo({ top: y, behavior: 'instant' });
      } catch(e) {
        console.error(e);
      }
    });
  </script>

{% endif %}
